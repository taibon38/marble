{% extends 'app/base.html' %}
{% load static %}

{% block content %}
<div class="container mt-3">
    <div class="row">
        <div class="col-md-2">
            <img src={{movie.movie_icon.url}} class="movie_icon">
        </div>
        <div class="col">
            <h4 class="text-left">作品名：{{movie.title}}</h4>
            <p class="text-left">公開日：{{movie.publication_date}}</p>
            <P class="text-left">上映時間：{{movie.screening_time}}分</P>
        </div>
        {% if request.user.is_authenticated %}
            <div class="col">                    
                <form action="{% url 'app:toggle_fav_movies' %}" method="post">{% csrf_token %}
                    <input type="hidden" name="movie_id" value="{{ movie.id }}">
                    {% if movie in user.faved_movies.all %}
                        <input type="submit" name="submit" class="btn btn-light" value="お気に入りから外す" /> 
                    {% else %}
                        <input type="submit" name="submit" class="btn btn-info" value=" お気に入り登録" />
                    {% endif %}
                </form>
                <form action="{% url 'app:toggle_watch_movies' %}" method="post" class="mt-1">{% csrf_token %}
                    <input type="hidden" name="movie_id" value="{{ movie.id }}">
                    {% if movie in user.watched_movies.all %}
                        <input type="submit" name="submit" class="btn btn-light" value="観たよから外す" /> 
                    {% else %}
                        <input type="submit" name="submit" class="btn btn-info" value=" 観たよ" />
                    {% endif %}
                </form>
            </div>
        {% endif %}
    </div>
</div>

<div class="container mt-5 mb-5">
    <div class="accordion" id="collapse-accordion">
        <div class="card mb-2">
            <div class="card-header" id="headingOne">
                <h5 class="mb-0">
                <button class="btn btn-block text-left" type="button" data-toggle="collapse" data-target="#collapse-accordion-1">
                    あらすじ
                </button>
                </h5>
            </div>
            <div id="collapse-accordion-1" class="collapse" data-parent="#collapse-accordion">
                <div class="card-body">
                {{movie.sumally}}
                </div>
            </div>
        </div>
        <div class="card mb-2">
            <div class="card-header" id="headingOne">
                <h5 class="mb-0">
                <button class="btn btn-block text-left " type="button" data-toggle="collapse" data-target="#collapse-accordion-2">
                解説
                </button>
                </h5>
            </div>
            <div id="collapse-accordion-2" class="collapse" data-parent="#collapse-accordion">
                <div class="card-body">
                {{movie.detail}}
                </div>
            </div>
        </div>
    </div>
</div>


<div class="accordion-wrap">
    <div class="accordion-item">
        <p class="accordion-header"> あらすじ <i class="fa fa-angle-down" aria-hidden="true"></i> </p>
    </div>
    <div class="accordion-text">
        <p> {{movie.sumally}} </p>
    </div>
</div>


<div class="accordion-wrap">
    <div class="accordion-item">
        <p class="accordion-header"> 解説 <i class="fa fa-angle-down" aria-hidden="true"></i> </p>
    </div>
    <div class="accordion-text">
        <p> {{movie.detail}} </p>
    </div>
</div>



    <p>楽しみ方カテゴリ：</p>
        {% for category in movie.categories.all %}
            <a href="{% url 'app:search_category' category=category.title %}">
                <button type="button" class ="btn btn-light "> {{ category.title }}</button>
            </a>
        {% endfor %}

    <p>キャラクター詳細:</p>
        {% for character in movie.characters.all %}
            <a href="{% url 'app:character' character.id %}">
                <button type="button" class ="btn btn-light">{{character.name}}</button> 
            </a>
        {% endfor %}
</div>



{% endblock %}